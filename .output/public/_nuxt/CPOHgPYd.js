import{F as c,E as u,a as w}from"./TKIaKC47.js";import{r as C}from"./dkZT_yf8.js";import{u as h}from"./DXMCFHUu.js";import{e as E,s as L,r as b,p as N,q as z,o as d,j as D,w as _,a as e,b as n,h as s,v as g,c as x,l as M,F as T,n as j,t as q}from"./DYYBa1ra.js";const O={class:"form__group"},R={class:"form__group"},$={class:"form__group"},A={class:"custom__checkbox__group"},G={class:"custom__checkbox"},H=["value"],I={class:"custom__checkbox__text"},J={class:"text--right"},X=E({__name:"form",props:{role:{}},emits:["update"],setup(F,{emit:k}){const i=F,y=k,{permissionList:p}=L(h()),{fetch:S}=h(),m=b(!1),r=b(),V=o=>{m.value=!0,$fetch("/api/role",{method:"POST",body:{...o}}).then(()=>{y("update")}).finally(()=>{m.value=!1})},B=()=>{var o,t,a,l,f,v;(o=r.value)==null||o.resetForm(),i.role&&((a=r.value)==null||a.setFieldValue("id",(t=i.role)==null?void 0:t.id),(l=r.value)==null||l.setFieldValue("name",i.role.name),(f=r.value)==null||f.setFieldValue("description",i.role.description||""),(v=r.value)==null||v.setFieldValue("permissions",i.role.permissions.map(P=>P.id)))};return N(()=>{var o;p.value.length==0&&S(),(o=r.value)==null||o.resetForm()}),z(i,()=>{B()},{deep:!0,immediate:!0}),(o,t)=>(d(),D(s(w),{class:"form","validation-schema":s(C),onSubmit:V,ref_key:"form",ref:r},{default:_(()=>[e("div",O,[t[0]||(t[0]=e("label",{for:"rf__name"},"Name",-1)),n(s(c),{name:"name",type:"text"}),n(s(u),{name:"name",class:"input--error"})]),e("div",R,[t[1]||(t[1]=e("label",{for:"rf__description"},"Description",-1)),n(s(c),{name:"description"},{default:_(({field:a})=>[e("textarea",g(a,{id:"rf__description"}),null,16)]),_:1}),n(s(u),{name:"description",class:"input--error"})]),e("div",$,[t[2]||(t[2]=e("strong",{class:"label"},"Permissions",-1)),e("div",A,[(d(!0),x(T,null,M(s(p),a=>(d(),x("label",G,[n(s(c),{name:"permissions",type:"checkbox",value:a.id},{default:_(({field:l})=>[e("input",g({type:"checkbox",value:a.id,ref_for:!0},l),null,16,H)]),_:2},1032,["value"]),e("span",I,q(a.name),1)]))),256))]),n(s(u),{name:"permissions",class:"input--error"})]),e("div",J,[e("button",{type:"submit",class:j({"btn btn__primary":!0,loading:s(m)})},"Save",2)])]),_:1},8,["validation-schema"]))}});export{X as _};
//# sourceMappingURL=CPOHgPYd.js.map
