{"version":3,"file":"9wfqB8ne.js","sources":["../../../../pages/dashboard/product/_component/productDescription.vue"],"sourcesContent":["<script setup lang=\"ts\">\n    import type { Product } from '@prisma/client'\n    import { debounce } from '~/lib/helper/debounce'\n\n    interface ProductDescriptionProps {\n        product: Product\n    }\n\n    const props = defineProps<ProductDescriptionProps>()\n    const emit = defineEmits(['update'])\n    const route = useRoute()\n\n    const productDescription = ref('')\n    const isLoading = ref(false)\n    const isSaved = ref(false)\n\n    watch(productDescription, async (newDescription) => {\n        const hasChanged = newDescription !== props.product?.description\n\n        if (hasChanged) {\n            isLoading.value = true\n\n            await $fetch(`/api/product/${route.params.id}/update_description`, {\n                method: 'PUT',\n                body: {\n                    description: productDescription.value\n                }\n            })\n                .then(() => {\n                    emit('update')\n                    isSaved.value = true\n                })\n                .finally(() => {\n                    isLoading.value = false\n                })\n        }\n    })\n\n    watch(() => props.product, () => {\n        if (props.product)\n            productDescription.value = props.product.description || ''\n    })\n\n    watch(isSaved, () => {\n        if (isSaved.value)\n            debounce(() => { isSaved.value = false }, 2000)\n    })\n\n    onMounted(() => {\n        if (props.product)\n            productDescription.value = props.product.description || ''\n    })\n</script>\n\n<template>\n    <div class=\"content__block\">\n        <div class=\"content__block__title\">\n            <h2>Product description</h2>\n            <span class=\"loading\" v-if=\"isLoading\"></span>\n            <span class=\"text--success\" v-if=\"isSaved\">\n                <MdiIcon preserveAspectRatio=\"xMidYMid meet\" icon=\"mdiContentSaveCheck\" />\n                saved\n            </span>\n        </div>\n        <TiptapEditor v-model=\"productDescription\" :disabled=\"isLoading\" />\n    </div>\n</template>"],"names":["props","__props","emit","__emit","route","useRoute","productDescription","ref","isLoading","isSaved","watch","newDescription","_a","debounce","onMounted"],"mappings":"gbAQI,MAAMA,EAAQC,EACRC,EAAOC,EACPC,EAAQC,IAERC,EAAqBC,EAAI,EAAE,EAC3BC,EAAYD,EAAI,EAAK,EACrBE,EAAUF,EAAI,EAAK,EAEnB,OAAAG,EAAAJ,EAAoB,MAAOK,GAAmB,OAC7BA,MAAmBC,EAAAZ,EAAM,UAAN,YAAAY,EAAe,eAGjDJ,EAAU,MAAQ,GAElB,MAAM,OAAO,gBAAgBJ,EAAM,OAAO,EAAE,sBAAuB,CAC/D,OAAQ,MACR,KAAM,CACF,YAAaE,EAAmB,KACpC,CAAA,CACH,EACI,KAAK,IAAM,CACRJ,EAAK,QAAQ,EACbO,EAAQ,MAAQ,EAAA,CACnB,EACA,QAAQ,IAAM,CACXD,EAAU,MAAQ,EAAA,CACrB,EACT,CACH,EAEKE,EAAA,IAAMV,EAAM,QAAS,IAAM,CACzBA,EAAM,UACaM,EAAA,MAAQN,EAAM,QAAQ,aAAe,GAAA,CAC/D,EAEDU,EAAMD,EAAS,IAAM,CACbA,EAAQ,OACRI,EAAS,IAAM,CAAEJ,EAAQ,MAAQ,IAAS,GAAI,CAAA,CACrD,EAEDK,EAAU,IAAM,CACRd,EAAM,UACaM,EAAA,MAAQN,EAAM,QAAQ,aAAe,GAAA,CAC/D"}