import{_ as z}from"./DWCHefLH.js";import{i as H,c as R,a as k,u as V,F,E as S,b as j,d as G,_ as O,f as I}from"./Bx6eGVLg.js";import{G as J,r as v,e as A,s as B,f as M,l as T,o as _,g as K,w as y,a as e,b as u,u as a,m as E,c as h,i as L,F as C,n as Q,t as b,h as W,k as X,j as q,d as w,p as D}from"./Cmvx1_hi.js";import{u as Y}from"./-vAn22QH.js";import".prisma/client/index-browser";H.Prisma.validator()({include:{category:!0,prices:!0,images:!0,stock:!0}});const N=J("product",()=>{const x=v([]);return{fetchProduct:async()=>{const n=await $fetch("/api/product");n.status=="success"&&(x.value=n.data)},saveProduct:n=>new Promise((l,i)=>{$fetch("/api/product",{method:"POST",body:n}).then(r=>{r.status=="success"?l(!0):i(r.message)})}),productList:x}}),Z=R().shape({name:k().required().label("Name"),description:k().required().label("Description"),category_id:k().required().label("Category")}),ee={class:"form__group"},te={class:"form__group"},se={class:"form__group"},ae=["value"],oe=["value"],ne={class:"text--right"},le=A({__name:"form",props:{product:{}},emits:["update-form"],setup(x,{emit:g}){const c=x,n=g,{fetchCategory:l}=V(),{categoryList:i}=B(V()),{saveProduct:r}=N(),d=v(),$=v(!1),P=(f,{resetForm:o})=>{$.value=!0,r({...f}).then(()=>{n("update-form"),o()}).finally(()=>{$.value=!1})},t=()=>{var f,o,s,m,p;(f=d.value)==null||f.resetForm(),c.product&&((o=d.value)==null||o.setFieldValue("id",c.product.id),(s=d.value)==null||s.setFieldValue("name",c.product.name),(m=d.value)==null||m.setFieldValue("description",c.product.description||""),(p=d.value)==null||p.setFieldValue("category_id",c.product.category_id||""))};return M(c,()=>{t()},{deep:!0,immediate:!0}),T(()=>{i.value.length==0&&l()}),(f,o)=>(_(),K(a(j),{"validation-schema":a(Z),onSubmit:P,ref_key:"form",ref:d},{default:y(()=>[e("div",ee,[o[0]||(o[0]=e("label",{for:"pf__name"},"Name",-1)),u(a(F),{type:"text",name:"name",id:"pf__name"}),u(a(S),{name:"name",class:"input--error"})]),e("div",te,[o[1]||(o[1]=e("label",{for:"pf__description"},"Description",-1)),u(a(F),{name:"description"},{default:y(({field:s})=>[e("textarea",E(s,{id:"pf__description"}),null,16)]),_:1}),u(a(S),{class:"input--error",name:"description"})]),e("div",se,[o[3]||(o[3]=e("label",{for:"cf__category_id"},"Category",-1)),u(a(F),{name:"category_id"},{default:y(({field:s})=>[e("select",E(s,{id:"cf__category_id"}),[o[2]||(o[2]=e("option",{value:""},"Select a parent",-1)),(_(!0),h(C,null,L(a(i),m=>(_(),h(C,null,[e("option",{value:m.id},b(m.name),9,ae),m.predecessor.length>0?(_(!0),h(C,{key:0},L(m.predecessor,p=>(_(),h("option",{value:p.id},"   "+b(p.name),9,oe))),256)):W("",!0)],64))),256))],16)]),_:1}),u(a(S),{class:"input--error",name:"category_id"})]),e("div",ne,[e("button",{type:"submit",class:Q({"btn btn__primary":!0,loading:a($)})},"Save",2)])]),_:1},8,["validation-schema"]))}}),ie={class:"datatable__section"},re={class:"datatable__header"},de={class:"datatable__header__action"},ue={class:"datatable__body"},ce={class:"sn"},me={class:"wrap"},pe={class:"image"},_e=["alt"],fe={class:"holder"},ve={class:"subtitle"},he={class:"text--center"},ge={class:"text--right"},be=["onClick"],ye=["onClick"],ke=A({__name:"index",setup(x){Y({title:"Products :: Himalayan Beads"});const{fetchProduct:g}=N(),{productList:c}=B(N()),n=v(!1),l=v(!1),i=v(null),r=v(null),d=X(()=>r.value!=null),$=()=>{var P;n.value=!0,$fetch(`/api/category/${(P=r.value)==null?void 0:P.id}/`,{method:"DELETE"}).then(()=>{r.value=null,g()}).finally(()=>{n.value=!1})};return M(i,()=>{i.value?l.value=!0:l.value=!1}),T(()=>{g()}),(P,t)=>{const f=z,o=O;return _(),h("section",ie,[e("header",re,[t[7]||(t[7]=e("div",{class:"datatable__header__holder"},[e("h1",null,"Product")],-1)),e("div",de,[e("a",{class:"btn btn__primary",href:"#",onClick:t[0]||(t[0]=q(s=>l.value=!0,["prevent"]))},t[6]||(t[6]=[e("span",{class:"prepend-icon icon-add"},null,-1),w(" Add Product ")]))])]),e("div",ue,[e("table",null,[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"text--left"},"Name"),e("th",null,"Created at"),e("th",{class:"text--right"},"Action")])],-1)),e("tbody",null,[(_(!0),h(C,null,L(a(c),(s,m)=>{var p;return _(),h("tr",{key:s.id},[e("td",ce,b(m+1),1),e("td",null,[e("div",me,[e("figure",pe,[e("img",{src:"",alt:s.name},null,8,_e)]),e("div",fe,[u(f,{to:"/dashboard/product/"+s.id,class:"title"},{default:y(()=>[w(b(s.name),1)]),_:2},1032,["to"]),e("em",ve,b((p=s.category)==null?void 0:p.name),1)])])]),e("td",he,b(a(I)(s.createdAt)),1),e("td",ge,[e("a",{class:"btn btn--xs btn__info",href:"#",onClick:q(U=>i.value=s,["prevent"])},t[8]||(t[8]=[e("span",{class:"prepend-icon icon-edit"},null,-1),w(" Edit ")]),8,be),e("a",{class:"btn btn--xs btn__danger",href:"#",onClick:q(U=>r.value=s,["prevent"])},t[9]||(t[9]=[e("span",{class:"prepend-icon icon-trash"},null,-1),w(" Delete ")]),8,ye)])])}),128))])])]),u(o,{show:a(l),"onUpdate:show":t[2]||(t[2]=s=>D(l)?l.value=s:null),"onModal:close":t[3]||(t[3]=s=>i.value=null)},{default:y(()=>[u(le,{product:a(i)||null,onUpdateForm:t[1]||(t[1]=()=>{l.value=!1,a(g)()})},null,8,["product"])]),_:1},8,["show"]),u(G,{title:"Are you sure you want delete?",show:a(d),"onUpdate:show":t[4]||(t[4]=s=>D(d)?d.value=s:null),loading:a(n),"onUpdate:loading":t[5]||(t[5]=s=>D(n)?n.value=s:null),onCancel:()=>{r.value=null},onConfirm:$},{default:y(()=>t[11]||(t[11]=[e("p",null,"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Aliquid quo, explicabo necessitatibus laboriosam a voluptatem hic ratione eius excepturi doloremque quidem odit eaque blanditiis illo obcaecati. Dicta adipisci accusantium quidem.",-1)])),_:1},8,["show","loading","onCancel"])])}}});export{ke as default};
//# sourceMappingURL=C_z6RzDi.js.map
