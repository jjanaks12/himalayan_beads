import{_ as V}from"./BIFzPT6V.js";import{_ as D}from"./DGLGZj_q.js";import{e as F,E as T,G,o as i,j as z,w as b,a as e,c as a,b as r,B as w,t as h,i as g,d as y,r as v,q as N,h as o,n as $,F as R,l as S,_ as H}from"./DYYBa1ra.js";import{_ as P}from"./Csgg6aYR.js";import{u as U}from"./BD13MmOs.js";import"./CfwLjDUh.js";const J={class:"confirm__dialog"},K={key:0,class:"icon__holder"},Q={class:"text__holder"},W={class:"confirm__dialog__action"},X=F({__name:"Confirm",props:T({title:{},text:{},icon:{default:"mdiHelpCircle"},confirmText:{default:"Yes"},cancelText:{default:"No"}},{show:{required:!0,default:!1},showModifiers:{}}),emits:T(["confirmed","canceled"],["update:show"]),setup(A,{emit:Y}){const d=Y,m=G(A,"show"),c=()=>{d("confirmed")},k=()=>{d("canceled"),m.value=!1};return(_,I)=>{const l=V,n=D;return i(),z(n,{show:m.value,"onModal:close":k},{default:b(()=>[e("div",J,[_.icon?(i(),a("div",K,[r(l,{preserveAspectRatio:"xMidYMid meet",icon:_.icon,size:"64"},null,8,["icon"])])):w("",!0),e("h2",null,h(_.title),1),e("div",Q,[e("p",null,h(_.text),1)]),e("div",W,[e("a",{href:"#",class:"btn btn__primary btn--outline",onClick:g(k,["prevent"])},[r(l,{preserveAspectRatio:"xMidYMid meet",icon:"mdiClose"}),y(" "+h(_.cancelText),1)]),e("a",{href:"#",class:"btn btn__primary",onClick:g(c,["prevent"])},[r(l,{preserveAspectRatio:"xMidYMid meet",icon:"mdiCheck"}),y(" "+h(_.confirmText),1)])])])]),_:1},8,["show"])}}}),Z={class:"content__block"},ee={class:"image__section"},te={class:"custom__file"},se={class:"custom__file__list"},oe={class:"custom__file__list__item"},ie=["src","alt"],ne=["onClick"],le={class:"custom__file__list__item custom__file__list__item--last"},ae={class:"holder"},ce={key:1,class:"custom__file__list__item"},_e={class:"image__list"},re=["onClick"],de=["src"],ue={class:"image__action"},me={key:0,class:"image__action__item"},fe=["onClick"],pe=["onClick"],ve=["onClick"],he={key:0},ge=["onClick"],ke={key:0,class:"image__holder"},Ce=["src"],Me=F({__name:"imageBlock",props:{id:{},images:{}},emits:["update"],setup(A,{emit:Y}){const d=A,m=Y,{files:c,handleFileInput:k}=U(),_=v(!1),I=v(!1),l=v(null),n=v(null),B=v(!1),f=v({}),E=()=>{_.value=!0,$fetch(`/api/product/${d.id}/images`,{method:"POST",body:{files:c.value,product_id:d.id}}).then(()=>{c.value=[],m("update")}).finally(()=>{_.value=!1})},O=async()=>{n.value&&(f.value[n.value]=!0,await $fetch(`/api/product/${d.id}/images/${n.value}`,{method:"delete"}).then(u=>{u.status=="success"&&m("update")}).finally(()=>{n.value&&(f.value[n.value]=!1,n.value=null)}))},q=async u=>{f.value[u]=!0,await $fetch(`/api/product/${d.id}/images/${u}`,{method:"put"}).then(t=>{t.status=="success"&&m("update")}).finally(()=>{f.value[u]=!1})};return N(l,()=>{I.value=l.value!=null}),N(n,()=>{B.value=n.value!=null}),(u,t)=>{const C=V,L=D,j=X;return i(),a("div",Z,[t[8]||(t[8]=e("div",{class:"content__block__title"},[e("h2",null,"Images")],-1)),e("div",ee,[e("label",te,[e("input",{type:"file",onChange:t[0]||(t[0]=(...s)=>o(k)&&o(k)(...s)),name:"file",multiple:"",accept:"image/*"},null,32),e("div",{class:$({custom__file__text:!0,"custom__file__text--has__files":o(c).length>0})},[e("ol",se,[o(c).length>0?(i(),a(R,{key:0},[(i(!0),a(R,null,S(o(c),(s,x)=>(i(),a("li",oe,[e("img",{src:s.content,alt:s.name},null,8,ie),e("a",{href:"#",onClick:g(p=>o(c).splice(x,1),["prevent"])},t[3]||(t[3]=[e("span",{class:"icon-add"},null,-1)]),8,ne)]))),256)),e("li",le,[e("div",ae,[e("span",null,"You have selected "+h(o(c).length)+" image"+h(o(c).length>1?"s":""),1),e("button",{class:$({"btn btn__primary":!0,loading:o(_)}),onClick:E}," save images ",2)])])],64)):(i(),a("li",ce,t[4]||(t[4]=[e("strong",null,"Upload files",-1),e("em",null,"(You can choose multiple images)",-1)])))])],2)]),e("div",_e,[(i(!0),a(R,null,S(u.images,s=>{var x;return i(),a("figure",{class:$({image:!0,"image--featured":s.featured})},[e("a",{href:"#",onClick:p=>{var M;return l.value=(M=s.images)==null?void 0:M.url}},[e("img",{src:(x=s.images)==null?void 0:x.url,alt:"image description"},null,8,de)],8,re),e("div",ue,[s.featured?(i(),a("span",me,[r(C,{preserveAspectRatio:"xMidYMid meet",icon:"mdiStar",class:"featured--icon text--warning"})])):w("",!0),r(P,{as:"ul"},{opener:b(({clickHandler:p})=>[e("a",{href:"#",class:$({"dropdown__opener image__action__item image__action__item--link":!0,loading:o(f)[s.id]}),onClick:g(p,["prevent"])},[o(f)[s.id]?w("",!0):(i(),z(C,{key:0,preserveAspectRatio:"xMidYMid meet",icon:"mdiDotsVertical",size:"24"}))],10,fe)]),default:b(()=>[e("li",null,[e("a",{href:"#",onClick:g(p=>n.value=s.id,["prevent"])},[t[5]||(t[5]=y(" Delete ")),r(C,{preserveAspectRatio:"xMidYMid meet",icon:"mdiTrashCan"})],8,pe)]),e("li",null,[e("a",{href:"#",onClick:p=>{var M;return l.value=(M=s.images)==null?void 0:M.url}},[t[6]||(t[6]=y(" view ")),r(C,{preserveAspectRatio:"xMidYMid meet",icon:"mdiEye"})],8,ve)]),s.featured?w("",!0):(i(),a("li",he,[e("a",{href:"#",onClick:g(p=>q(s.id),["prevent"])},[t[7]||(t[7]=y(" Set as featured ")),r(C,{preserveAspectRatio:"xMidYMid meet",icon:"mdiStarCircleOutline"})],8,ge)]))]),_:2},1024)])],2)}),256))]),r(L,{show:o(I),size:"xl","onModal:close":t[1]||(t[1]=s=>l.value=null)},{default:b(()=>[o(l)?(i(),a("div",ke,[e("img",{src:o(l),alt:"image description"},null,8,Ce)])):w("",!0)]),_:1},8,["show"]),r(j,{show:o(B),title:"Are you sure you want to delete?",text:"Once you delete this image you cannot go back.",onConfirmed:O,onCanceled:t[2]||(t[2]=s=>n.value=null),"cancel-text":"No, not now","confirm-text":"Yes, delete it"},null,8,["show"])])])}}}),Ye=H(Me,[["__scopeId","data-v-7544230b"]]);export{Ye as default};
//# sourceMappingURL=nwa1PKU6.js.map
