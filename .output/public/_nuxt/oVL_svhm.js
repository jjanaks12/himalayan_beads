import{_ as j}from"./CfQIW0-U.js";import{e as T,s as U,r as k,q as z,o,j as N,w as h,h as n,B as D,a as e,b as r,v as L,c as l,l as q,F as w,n as I,i as C,t as _,C as G,p as J,d as x,z as S}from"./DYYBa1ra.js";import{f as M}from"./Dg8VEt95.js";import{u as A,_ as K}from"./Bm_wC_HY.js";import{_ as O}from"./DGLGZj_q.js";import{c as Q,b as P,F,E as V,a as W}from"./TKIaKC47.js";import{u as X}from"./BD13MmOs.js";import{u as Y}from"./DyWVWhbP.js";import"./D2hDXtRd.js";import"./CfwLjDUh.js";const Z=Q({name:P().required().label("Name"),description:P().label("Description")}),ee={class:"form__group"},te={class:"form__group"},se={class:"form__group"},ne={class:"custom__file"},oe={class:"custom__file__text"},le={class:"custom__file__list"},ae={class:"custom__file__list__item"},ie=["src","alt"],re=["onClick"],de={key:1,class:"custom__file__list__item"},ue={class:"form__group"},ce=["value"],_e={class:"text--right"},me=T({__name:"form",props:{category:{}},emits:["update-form"],setup(B,{emit:E}){const d=B,m=E,{saveCategory:b}=A(),{categoryList:g}=U(A()),{files:i,handleFileInput:p}=X(),v=k(),$=k(!1),y=(f,{resetForm:t})=>{$.value=!0,b({...f,files:i.value}).then(()=>{m("update-form"),t()}).finally(()=>{$.value=!1})},s=()=>{var f,t,a,c,u;(f=v.value)==null||f.resetForm(),d.category&&((t=v.value)==null||t.setFieldValue("id",d.category.id),(a=v.value)==null||a.setFieldValue("name",d.category.name),(c=v.value)==null||c.setFieldValue("description",d.category.description||""),(u=v.value)==null||u.setFieldValue("parent_category",d.category.parent_id||""),i.value=[])};return z(d,()=>{s()},{deep:!0,immediate:!0}),(f,t)=>(o(),N(n(W),{class:"form",action:"#","validation-schema":n(Z),onSubmit:y,ref_key:"form",ref:v},{default:h(()=>[d.category?(o(),N(n(F),{key:0,type:"hidden",name:"id"})):D("",!0),e("div",ee,[t[1]||(t[1]=e("label",{for:"cf__name"},"Name",-1)),r(n(F),{type:"text",name:"name",id:"cf__name",autocomplete:"name"}),r(n(V),{class:"input--error",name:"name"})]),e("div",te,[t[2]||(t[2]=e("label",{for:"cf__description"},"Description",-1)),r(n(F),{name:"description"},{default:h(({field:a})=>[e("textarea",L(a,{id:"cf__description"}),null,16)]),_:1}),r(n(V),{class:"input--error",name:"description"})]),e("div",se,[e("label",ne,[e("input",{type:"file",onChange:t[0]||(t[0]=(...a)=>n(p)&&n(p)(...a)),name:"file",accept:"image/*"},null,32),e("div",oe,[e("ol",le,[n(i).length>0?(o(!0),l(w,{key:0},q(n(i),(a,c)=>(o(),l("li",ae,[e("img",{src:a.content,alt:a.name},null,8,ie),e("a",{href:"#",onClick:C(u=>n(i).splice(c,1),["prevent"])},t[3]||(t[3]=[e("span",{class:"icon-add"},null,-1)]),8,re)]))),256)):(o(),l("span",de,t[4]||(t[4]=[e("strong",null,"Select a file",-1)])))])])])]),e("div",ue,[t[6]||(t[6]=e("label",{for:"cf__parent_category"},"Parent category",-1)),r(n(F),{name:"parent_category"},{default:h(({field:a})=>[e("select",L(a,{id:"cf__parent_category"}),[t[5]||(t[5]=e("option",{value:""},"Select a parent",-1)),(o(!0),l(w,null,q(n(g),c=>(o(),l("option",{value:c.id},_(c.name),9,ce))),256))],16)]),_:1}),r(n(V),{class:"input--error",name:"parent_category"})]),e("div",_e,[e("button",{type:"submit",class:I({"btn btn__primary":!0,loading:n($)})},"Save",2)])]),_:1},8,["validation-schema"]))}}),pe={class:"datatable__section"},fe={class:"datatable__header"},ve={class:"datatable__header__action"},he={class:"datatable__body"},be={class:"sn"},ge={class:"wrap"},$e={key:0,class:"image"},Ce=["src","alt"],ke={class:"holder"},ye={class:"title"},xe={class:"badge badge--info"},we={class:"text--center nowrap"},Fe={class:"text--right nowrap"},De=["onClick"],qe=["onClick"],Ae=["onClick"],Ee={key:0,class:"icon-caret-d"},Se={key:1,class:"icon-caret-t"},Ve={key:0},Be={colspan:"4",class:"no--spacing"},Ne={class:"subtable"},Le={class:"sn"},Me={class:"text--center"},Pe={class:"text--right"},Oe=T({__name:"category",setup(B){Y({title:"Category :: Himalayan Beads"});const{categoryList:E}=U(A()),{fetchCategory:d}=A(),m=k(!1),b=k(!1),g=k({}),i=k(null),p=k(null),v=()=>{var y;b.value=!0,$fetch(`/api/category/${(y=p.value)==null?void 0:y.id}/`,{method:"DELETE"}).then(()=>{p.value=null,d()}).finally(()=>{b.value=!1})},$=G(()=>p.value!=null);return z(i,()=>{i.value?m.value=!0:m.value=!1}),J(()=>{d()}),(y,s)=>{const f=j;return o(),l("section",pe,[e("header",fe,[s[7]||(s[7]=e("div",{class:"datatable__header__holder"},[e("h1",null,"Product category")],-1)),e("div",ve,[r(f,{onClick:s[0]||(s[0]=C(t=>m.value=!0,["prevent"])),persmission:"create_category"},{default:h(()=>s[6]||(s[6]=[e("span",{class:"prepend-icon icon-add"},null,-1),x(" Add Category ")])),_:1})])]),e("div",he,[e("table",null,[s[12]||(s[12]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"text--left"},"Name"),e("th",null,"Created at"),e("th",{class:"text--right"},"Action")])],-1)),e("tbody",null,[(o(!0),l(w,null,q(n(E),(t,a)=>{var c;return o(),l(w,{key:t.id},[e("tr",null,[e("td",be,_(a+1),1),e("td",null,[e("div",ge,[t.image?(o(),l("figure",$e,[e("img",{src:((c=t.image)==null?void 0:c.url)||"",alt:t.name},null,8,Ce)])):D("",!0),e("div",ke,[e("strong",ye,_(t.name),1),e("em",xe,_(t._count.products)+" product"+_(t._count.products>1?"s":""),1)])])]),e("td",we,_(n(M)(t.createdAt)),1),e("td",Fe,[e("a",{class:"btn btn--xs btn__info",href:"#",onClick:C(u=>i.value=t,["prevent"])},s[8]||(s[8]=[e("span",{class:"prepend-icon icon-edit"},null,-1),x(" Edit ")]),8,De),e("a",{class:"btn btn--xs btn__danger",href:"#",onClick:C(u=>p.value=t,["prevent"])},s[9]||(s[9]=[e("span",{class:"prepend-icon icon-trash"},null,-1),x(" Delete ")]),8,qe),(t==null?void 0:t.predecessor.length)>0?(o(),l("a",{key:0,href:"#",class:"btn btn--xs btn__primary btn--outline",onClick:C(u=>n(g)[t.id]=n(g)[t.id]?!n(g)[t.id]:!0,["prevent"])},[n(g)[t.id]?(o(),l("span",Ee)):(o(),l("span",Se))],8,Ae)):D("",!0)])]),(t==null?void 0:t.predecessor.length)>0&&n(g)[t==null?void 0:t.id]?(o(),l("tr",Ve,[e("td",Be,[e("table",Ne,[e("tbody",null,[(o(!0),l(w,null,q(t.predecessor,(u,H)=>(o(),l("tr",null,[e("td",Le,_(a+1)+"."+_(H+1),1),e("td",Me,_(u.name),1),e("td",null,_(n(M)(u.createdAt)),1),e("td",Pe,[r(f,{onClick:C(R=>i.value=u,["prevent"]),persmission:"update_category"},{default:h(()=>s[10]||(s[10]=[e("span",{class:"prepend-icon icon-edit"},null,-1),x(" Edit ")])),_:2},1032,["onClick"]),r(f,{onClick:C(R=>p.value=u,["prevent"]),persmission:"delete_category"},{default:h(()=>s[11]||(s[11]=[e("span",{class:"prepend-icon icon-trash"},null,-1),x(" Delete ")])),_:2},1032,["onClick"])])]))),256))])])])])):D("",!0)],64)}),128))])])]),r(O,{show:n(m),"onUpdate:show":s[2]||(s[2]=t=>S(m)?m.value=t:null),"onModal:close":s[3]||(s[3]=t=>i.value=null)},{default:h(()=>[r(me,{category:n(i)||null,onUpdateForm:s[1]||(s[1]=()=>{m.value=!1,n(d)()})},null,8,["category"])]),_:1},8,["show"]),r(K,{title:"Are you sure you want delete?",show:n($),"onUpdate:show":s[4]||(s[4]=t=>S($)?$.value=t:null),loading:n(b),"onUpdate:loading":s[5]||(s[5]=t=>S(b)?b.value=t:null),onCancel:()=>{p.value=null},onConfirm:v},{default:h(()=>s[13]||(s[13]=[e("p",null,"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Aliquid quo, explicabo necessitatibus laboriosam a voluptatem hic ratione eius excepturi doloremque quidem odit eaque blanditiis illo obcaecati. Dicta adipisci accusantium quidem.",-1)])),_:1},8,["show","loading","onCancel"])])}}});export{Oe as default};
//# sourceMappingURL=oVL_svhm.js.map
