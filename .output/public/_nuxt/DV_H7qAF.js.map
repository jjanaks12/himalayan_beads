{"version":3,"file":"DV_H7qAF.js","sources":["../../../../store/role.ts","../../../../pages/dashboard/settings/role.vue"],"sourcesContent":["// import { Prisma } from '@prisma/client'\nimport { defineStore } from 'pinia'\n\n/* const roleWithProduct = Prisma.validator<Prisma.RoleDefaultArgs>()({\n    include: {\n        permissions: true\n    }\n})\nexport type RoleWithProduct = Prisma.RoleGetPayload<typeof roleWithProduct> */\n\nexport const useRoleStore = defineStore('role', () => {\n    const roleList = ref<any[]>([])\n\n    const fetchRoles = async () => {\n        const roles: any = await $fetch('/api/role', {\n            method: 'GET'\n        })\n\n        roleList.value = roles.data\n    }\n\n    return { roleList, fetchRoles }\n})","<script setup lang=\"ts\">\n    import { formatDate } from '~/lib/filter'\n    import { useRoleStore } from '~/store/role'\n\n    import RoleForm from '@/pages/dashboard/settings/_role/form.vue'\n\n    useHead({\n        title: 'Roles :: Himalayan Beads'\n    })\n\n    definePageMeta({\n        layout: 'admin',\n        middleware: ['auth', 'authorization'],\n        permission: 'view_role'\n    })\n\n    const { roleList } = storeToRefs(useRoleStore())\n    const { fetchRoles } = useRoleStore()\n\n    const showForm = ref(false)\n    const editRole = ref(null)\n\n    onMounted(() => {\n        fetchRoles()\n    })\n\n    watch(editRole, () => {\n        if (editRole.value)\n            showForm.value = true\n    }, { deep: true })\n</script>\n\n<template>\n    <section class=\"datatable__section\">\n        <header class=\"datatable__header\">\n            <div class=\"datatable__header__holder\">\n                <h1>Roles</h1>\n            </div>\n            <div class=\"datatable__header__action\">\n                <a class=\"btn btn__primary\" href=\"#\" @click.prevent=\"showForm = true\">\n                    <span class=\"prepend-icon icon-add\"></span>\n                    Add Roles\n                </a>\n            </div>\n        </header>\n        <div class=\"datatable__body\">\n            <table>\n                <thead>\n                    <tr>\n                        <th class=\"sn\"></th>\n                        <th class=\"text--left\">Name</th>\n                        <th>Created at</th>\n                        <th class=\"text--right\">Action</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr v-for=\"(role, index) in roleList\">\n                        <td class=\"sn\">{{ index + 1 }}</td>\n                        <td>\n                            <div class=\"wrap\">\n                                <div class=\"holder\">\n                                    <strong class=\"title\">{{ role.name }}</strong>\n                                    <div class=\"badge__group\">\n                                        <span class=\"badge badge--info\" v-for=\"permission in role.permissions\">{{\n                                            permission.name }}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                        <td class=\"text--center\">{{ formatDate(role.createdAt) }}</td>\n                        <td class=\"text--right\">\n                            <ThemeButton size=\"xl\" @click=\"editRole = role\" persmission=\"update_role\">\n                                <MdiIcon preserveAspectRatio=\"xMidYMid meet\" icon=\"mdiPencil\" size=\"16\" />\n                                edit\n                            </ThemeButton>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </section>\n    <Modal :show=\"showForm\" size=\"xl\" @modal:close=\"() => {\n        showForm = false\n        editRole = null\n    }\">\n        <RoleForm :role=\"editRole\" @update=\"() => {\n            showForm = false\n            editRole = null\n\n            fetchRoles()\n        }\" />\n    </Modal>\n</template>"],"names":["useRoleStore","defineStore","roleList","ref","roles","useHead","storeToRefs","fetchRoles","showForm","editRole","onMounted","watch"],"mappings":"4cAUa,MAAAA,EAAeC,EAAY,OAAQ,IAAM,CAC5C,MAAAC,EAAWC,EAAW,CAAA,CAAE,EAUvB,MAAA,CAAE,SAAAD,EAAU,WARA,SAAY,CACrB,MAAAE,EAAa,MAAM,OAAO,YAAa,CACzC,OAAQ,KAAA,CACX,EAEDF,EAAS,MAAQE,EAAM,IAAA,EAI/B,CAAC,2UChBWC,EAAA,CACJ,MAAO,0BAAA,CACV,EAQD,KAAM,CAAE,SAAAH,CAAa,EAAAI,EAAYN,EAAc,CAAA,EACzC,CAAE,WAAAO,GAAeP,IAEjBQ,EAAWL,EAAI,EAAK,EACpBM,EAAWN,EAAI,IAAI,EAEzB,OAAAO,EAAU,IAAM,CACDH,GAAA,CACd,EAEDI,EAAMF,EAAU,IAAM,CACdA,EAAS,QACTD,EAAS,MAAQ,GAAA,EACtB,CAAE,KAAM,EAAA,CAAM"}