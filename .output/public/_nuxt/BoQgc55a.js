import{_ as z}from"./Dieuq_5Q.js";import{u as V,a as H,_ as R}from"./C42XPPgq.js";import{J as j,r as v,e as A,s as B,j as M,x as T,o as _,k as J,w as y,a as e,b as u,h as o,m as E,c as h,p as L,F as C,n as O,t as g,l as G,v as I,q as k,d as w,y as F}from"./CwxkVYrh.js";import{i as K,f as Q}from"./CCEua1kr.js";import{c as W,b as q,F as S,E as D,a as X}from"./DkRoiBUv.js";import{u as Y}from"./Cl9i07Bu.js";import".prisma/client/index-browser";K.Prisma.validator()({include:{category:!0,prices:!0,images:!0,stock:!0}});const N=j("product",()=>{const x=v([]);return{fetchProduct:async()=>{const n=await $fetch("/api/product");n.status=="success"&&(x.value=n.data)},saveProduct:n=>new Promise((l,i)=>{$fetch("/api/product",{method:"POST",body:n}).then(r=>{r.status=="success"?l(!0):i(r.message)})}),productList:x}}),Z=W().shape({name:q().required().label("Name"),description:q().required().label("Description"),category_id:q().required().label("Category")}),ee={class:"form__group"},te={class:"form__group"},se={class:"form__group"},oe=["value"],ae=["value"],ne={class:"text--right"},le=A({__name:"form",props:{product:{}},emits:["update-form"],setup(x,{emit:b}){const c=x,n=b,{fetchCategory:l}=V(),{categoryList:i}=B(V()),{saveProduct:r}=N(),d=v(),$=v(!1),P=(f,{resetForm:a})=>{$.value=!0,r({...f}).then(()=>{n("update-form"),a()}).finally(()=>{$.value=!1})},t=()=>{var f,a,s,m,p;(f=d.value)==null||f.resetForm(),c.product&&((a=d.value)==null||a.setFieldValue("id",c.product.id),(s=d.value)==null||s.setFieldValue("name",c.product.name),(m=d.value)==null||m.setFieldValue("description",c.product.description||""),(p=d.value)==null||p.setFieldValue("category_id",c.product.category_id||""))};return M(c,()=>{t()},{deep:!0,immediate:!0}),T(()=>{i.value.length==0&&l()}),(f,a)=>(_(),J(o(X),{"validation-schema":o(Z),onSubmit:P,ref_key:"form",ref:d},{default:y(()=>[e("div",ee,[a[0]||(a[0]=e("label",{for:"pf__name"},"Name",-1)),u(o(S),{type:"text",name:"name",id:"pf__name"}),u(o(D),{name:"name",class:"input--error"})]),e("div",te,[a[1]||(a[1]=e("label",{for:"pf__description"},"Description",-1)),u(o(S),{name:"description"},{default:y(({field:s})=>[e("textarea",E(s,{id:"pf__description"}),null,16)]),_:1}),u(o(D),{class:"input--error",name:"description"})]),e("div",se,[a[3]||(a[3]=e("label",{for:"cf__category_id"},"Category",-1)),u(o(S),{name:"category_id"},{default:y(({field:s})=>[e("select",E(s,{id:"cf__category_id"}),[a[2]||(a[2]=e("option",{value:""},"Select a parent",-1)),(_(!0),h(C,null,L(o(i),m=>(_(),h(C,null,[e("option",{value:m.id},g(m.name),9,oe),m.predecessor.length>0?(_(!0),h(C,{key:0},L(m.predecessor,p=>(_(),h("option",{value:p.id},"   "+g(p.name),9,ae))),256)):G("",!0)],64))),256))],16)]),_:1}),u(o(D),{class:"input--error",name:"category_id"})]),e("div",ne,[e("button",{type:"submit",class:O({"btn btn__primary":!0,loading:o($)})},"Save",2)])]),_:1},8,["validation-schema"]))}}),ie={class:"datatable__section"},re={class:"datatable__header"},de={class:"datatable__header__action"},ue={class:"datatable__body"},ce={class:"sn"},me={class:"wrap"},pe={class:"image"},_e=["alt"],fe={class:"holder"},ve={class:"subtitle"},he={class:"text--center"},be={class:"text--right"},ge=["onClick"],ye=["onClick"],qe=A({__name:"index",setup(x){Y({title:"Products :: Himalayan Beads"});const{fetchProduct:b}=N(),{productList:c}=B(N()),n=v(!1),l=v(!1),i=v(null),r=v(null),d=I(()=>r.value!=null),$=()=>{var P;n.value=!0,$fetch(`/api/category/${(P=r.value)==null?void 0:P.id}/`,{method:"DELETE"}).then(()=>{r.value=null,b()}).finally(()=>{n.value=!1})};return M(i,()=>{i.value?l.value=!0:l.value=!1}),T(()=>{b()}),(P,t)=>{const f=z,a=R;return _(),h("section",ie,[e("header",re,[t[7]||(t[7]=e("div",{class:"datatable__header__holder"},[e("h1",null,"Product")],-1)),e("div",de,[e("a",{class:"btn btn__primary",href:"#",onClick:t[0]||(t[0]=k(s=>l.value=!0,["prevent"]))},t[6]||(t[6]=[e("span",{class:"prepend-icon icon-add"},null,-1),w(" Add Product ")]))])]),e("div",ue,[e("table",null,[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th"),e("th",{class:"text--left"},"Name"),e("th",null,"Created at"),e("th",{class:"text--right"},"Action")])],-1)),e("tbody",null,[(_(!0),h(C,null,L(o(c),(s,m)=>{var p;return _(),h("tr",{key:s.id},[e("td",ce,g(m+1),1),e("td",null,[e("div",me,[e("figure",pe,[e("img",{src:"",alt:s.name},null,8,_e)]),e("div",fe,[u(f,{to:"/dashboard/product/"+s.id,class:"title"},{default:y(()=>[w(g(s.name),1)]),_:2},1032,["to"]),e("em",ve,g((p=s.category)==null?void 0:p.name),1)])])]),e("td",he,g(o(Q)(s.createdAt)),1),e("td",be,[e("a",{class:"btn btn--xs btn__info",href:"#",onClick:k(U=>i.value=s,["prevent"])},t[8]||(t[8]=[e("span",{class:"prepend-icon icon-edit"},null,-1),w(" Edit ")]),8,ge),e("a",{class:"btn btn--xs btn__danger",href:"#",onClick:k(U=>r.value=s,["prevent"])},t[9]||(t[9]=[e("span",{class:"prepend-icon icon-trash"},null,-1),w(" Delete ")]),8,ye)])])}),128))])])]),u(a,{show:o(l),"onUpdate:show":t[2]||(t[2]=s=>F(l)?l.value=s:null),"onModal:close":t[3]||(t[3]=s=>i.value=null)},{default:y(()=>[u(le,{product:o(i)||null,onUpdateForm:t[1]||(t[1]=()=>{l.value=!1,o(b)()})},null,8,["product"])]),_:1},8,["show"]),u(H,{title:"Are you sure you want delete?",show:o(d),"onUpdate:show":t[4]||(t[4]=s=>F(d)?d.value=s:null),loading:o(n),"onUpdate:loading":t[5]||(t[5]=s=>F(n)?n.value=s:null),onCancel:()=>{r.value=null},onConfirm:$},{default:y(()=>t[11]||(t[11]=[e("p",null,"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Aliquid quo, explicabo necessitatibus laboriosam a voluptatem hic ratione eius excepturi doloremque quidem odit eaque blanditiis illo obcaecati. Dicta adipisci accusantium quidem.",-1)])),_:1},8,["show","loading","onCancel"])])}}});export{qe as default};
//# sourceMappingURL=BoQgc55a.js.map
